# 锁

## 全局锁

锁定数据库中所有表, 整个数据库处于**只读状态**.

使用场景: 数据库的逻辑备份, 获取全局锁, 保证**数据一致性**.

如果获取主库全局锁, 会造成**业务停滞**; 如果获取从库全局锁, 会造成**主从延迟**.

在可重复读隔离级别下, 可以通过事务保证数据一致性.

## 表级锁

### 表锁

锁定数据库中单个表(S/X).

### 元数据锁

对表进行增删改查时, 获取元数据锁(S); 对表进行结构变更时, 获取元数据锁(X); 提交事务时, 释放元数据锁.

在更新表结构时, 如果获取不到元数据锁, 可以手动终止未提交的事务, 防止阻塞后续增删改查操作.

### 意向锁

快速判断表里是否有记录被加锁, 减少获取表锁的检查时间.

## 行级锁

### 行锁

锁定数据库中单个记录(S/X).

### 间隙锁

锁定数据库中索引记录间隙, 用于解决幻读现象.